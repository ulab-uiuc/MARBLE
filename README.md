# Exploring the Essence of LLM Multi-agents Evaluation (MultiAgentBench)

[![Python 3.11](https://img.shields.io/badge/python-3.11-blue.svg)](https://www.python.org/downloads/release/python-31110/)
[![pre-commit](https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit&logoColor=white)](https://pre-commit.com/)
<a href="https://github.com/psf/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg"></a>
[![Checked with mypy](https://www.mypy-lang.org/static/mypy_badge.svg)](https://mypy-lang.org/)
[![bear-ified](https://raw.githubusercontent.com/beartype/beartype-assets/main/badge/bear-ified.svg)](https://beartype.readthedocs.io)

> [!NOTE]
> This repo is continously updating with more tools. Any contribution is welcome.

## ✨ Motivation

To ensure high standards in engineering projects, we offer a standardized template specifically designed for open-source Python research projects. This template is an excellent choice if you:

1. Want to facilitate seamless collaboration and extension of your project by other researchers.
2. Aim to bridge communication gaps among collaborators effectively.
3. Seek to make rapid iterations with assurance that small code modifications won’t disrupt the overall project.
4. Wish to reduce the frequency of frustrating runtime errors during experiments.

## 🔨 Get Started

You are required to use `Python` `3.11.x`, `Node.js` `18.18`, and `Java` `17`.  

To install python environment, you should use
```bash
poetry install
```

To install `Mineflayer`, you should execute
```bash
cd env/MineLand/mineland/sim/mineflayer
npm ci
```

or

```bash
cd env/MineLand/mineland/sim/mineflayer
pnpm install
```

Besides, you also need `ffmpeg`:
```bash
sudo apt update
sudo apt install ffmpeg
```

## 💼 Template Structure

The current project template supports the final package release of our codebase.

```
Template/
│
├── .github/                  # Contains GitHub related files like workflows
├── docs/                     # Documentation for the project
├── src/                      # Main package directory
├── stubs/                    # Type stubs for static typing (for mypy strict mode)
├── tests/                    # Test scripts and resources
│
├── .gitignore                # Specifies untracked files to ignore
├── .pre-commit-config.yaml   # Configurations for pre-commit hooks
├── poetry.lock               # Lock file generated by poetry for dependencies
├── pyproject.toml            # Project metadata and tool configurations
```

## ❓ Issue & Pull Request

An issue typically describes a new feature (`feature`), fixing an old bug (`bug`), launching a group of experiments (`exp`), or refactoring part of the code (`refactor`). Using different issue templates for different issues.

A PR typically implements the content mentioned in one issue.

Notice about the development:

1. When creating an issue, assign the responsible member for fixing that if possible
2. When creating a PR, make sure you uses `feature/feature-name`, `bug/bug-name`, `exp/exp-name` for its branch
3. When finishing one PR, make sure all the github action is passed and all the checks are done.
4. When merging one PR, make sure using `squash and merge` instead of `merge a pull request`.
5. Avoid making any direct commit to the `main` branch and try to avoid any `--force` push to any branch unless you are pretty sure about that.

## 👷 Type Checking

* Tools

  * static type checking (`mypy`)

  * dynamic type checking (`beartype`)

* Guidelines
  * Run `mypy --strict ./` under the root of the current repo to test the static type.

## 🏅️ Unit Testing

* Tools
  * testing code components based on testing function (`pytest`)

* Guidelines
  * Run `pytest` under the root of the current repo to check unit test results.

## 🧐 Code Spell Checking

* Tools
  * code spell checking (`codespell`)

* Guidelines
  * Commonly need to ignore part of the files in the repository like `/data`.

## 🪝 Pre-commit Hook

* Tools

  * code formatting (`prettier`)

  * import package sorting (`isort`)

  * ipynb output clear (`nbstripout`)

  * code bug checking and formatting (`ruff`)

* Guidelines

  * Run `python -m pip install pre-commit` to install `pre-commit`

  * Run `pre-commit install` to allow hooking pre-commit with any `git commit` commands.

## 🧑‍💼 Dependency Management

* Tools
  * We utilize `poetry` to support the dependency requirements. Dependency for different usage of the repo can be defined separately in `pyproject.toml`.

* Guidelines

  * Run `pip install poetry` to finish the installation of poetry.

  * Create `conda environment` with a specified Python version

  * Run `poetry install` to install required dependencies.

## ❤️ Contribution

I welcome all kinds of contributions, e.g. adding more tools, better practices, and discussion on trade-offs.

# Installation Instructions

## MineLand / MineFlayer

This bench uses [MineLand](https://github.com/cocacola-lab/MineLand), which is based on [Mineflayer](https://github.com/PrismarineJS/mineflayer), for the multi-agent MineCraft environment. While we recommend installing according to the official instructions, you might also try out these solutions once you encounter issues.

### 1. When `npm ci` or `pnpm install` fails
Check if your `node.js` version is 18.18.0, as instructed by MineLand.

### 2. Failed to install `mineland` package to your (virtual) python environment
Instead of `pip install -e .`, use `python -m pip install -e .`.

### 3. When running `mineland`, shows up minecraft-data range error
```bash
[Mineflayer] RangeError: Version '1.20.3' not found in [23w43a ; 23w42a ; 23w41a ; 23w40a ; 1.20.2 ; 1.20.2-rc2 ; 1.20.2-rc1 ; 1.20.2-pre4 ; ...; 1.0] for pc
```
This implies that your MineCraft server version is in fact `'1.20.3'`. There might have been a typo in line `32` in `mineland/sim/bridge.py`, which should be 
```python
        minecraft_version: str = "1.19",
```
instead of
```python
        minecraft_version: str = 1.19,
```
which might have caused the server to be automatically collected as a newer version.  
You might renew your environment, fix this code and re-initiate. Or, you might update `minecraft-data` to a newer version (although admittedly this is not a good solution):
```bash
npm install minecraft-data@3.69.0 --save
```

### 4. When encountering `ffmpeg` Warning
```bash
/directory-of-your-python-env/lib/python3.11/site-packages/pydub/utils.py:170: RuntimeWarning: Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work
  warn("Couldn't find ffmpeg or avconv - defaulting to ffmpeg, but may not work", RuntimeWarning)
```
Install `ffmpeg`.